suite: mesh test
tests:
  - it: should install mesh
    set:
      mesh.enabled: true
    template: mesh/daemon-set.yaml
    asserts:
      - isKind:
          of: DaemonSet
      - isAPIVersion:
          of: apps/v1
      - equal:
          path: metadata.name
          value: default-mesh-proxy
      - hasDocuments:
          count: 1
  - it: should install coredns
    set:
      mesh.kubedns: true
      mesh.enabled: true
    template: mesh/coredns/deployment.yaml
    asserts:
      - isKind:
          of: Deployment
      - isAPIVersion:
          of: apps/v1
      - equal:
          path: metadata.name
          value: coredns
      - hasDocuments:
          count: 1
